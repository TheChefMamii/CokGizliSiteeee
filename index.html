<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sen ve Ben</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(-45deg, #f8bbd0, #e91e63, #bbdefb, #90caf9);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            perspective: 1000px;
            transition: background 0.5s ease;
        }
        body.dark-mode {
            background: linear-gradient(-45deg, #2c003e, #4b0082, #1e1e2f, #3f3f74);
        }
        body.dark-mode .bg-overlay {
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgba(255,255,255,0.2)"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>') repeat;
            background-size:30px;
            opacity:0.2;
        }
        body.dark-mode .main-card {
            background: rgba(30, 30, 50, 0.85);
            border: 1px solid rgba(255,255,255,0.2);
            color: #f0e6ff;
        }
        body.dark-mode .subtitle { color: #d0c4ff; }
        body.dark-mode .greeting { color: #bb86fc; }
        body.dark-mode .box { background: rgba(187, 134, 252, 0.2); color: #bb86fc; }
        body.dark-mode .button { background: #bb86fc; box-shadow: 0 4px 15px rgba(187, 134, 252, 0.4); }
        body.dark-mode .button:hover { background: #9f6ed3; box-shadow: 0 6px 20px rgba(187, 134, 252, 0.5); }
        @keyframes gradientBG {
            0% { background-position:0% 50%; }
            50% { background-position:100% 50%; }
            100% { background-position:0% 50%; }
        }
        .bg-overlay {
            position:absolute; top:0; left:0;
            width:100%; height:100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgba(255,255,255,0.2)"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>') repeat;
            background-size:30px;
            opacity:0.1;
        }
        .main-card {
            background: rgba(255,255,255,0.85);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            padding:20px;
            text-align:center;
            box-shadow:0 8px 25px rgba(0,0,0,0.2);
            max-width:90%;
            width:500px;
            animation: fadeIn 1s ease-out;
            transition: transform 0.1s ease, background 0.5s ease, color 0.5s ease;
        }
        @keyframes fadeIn { 0% { opacity:0; transform:scale(0.95);} 100% {opacity:1; transform:scale(1);} }
        h1 { font-family:'Playfair Display', serif; font-size:2.2em; color:#e91e63; margin-bottom:12px; text-shadow:2px 2px 10px rgba(0,0,0,0.1);}
        body.dark-mode h1 { color: #bb86fc; }
        .subtitle { font-size:0.9em; color:#555; margin-bottom:8px; font-weight:300;}
        .greeting { font-size:1em; color:#e91e63; margin-bottom:15px; font-style:italic; opacity:0; animation: fadeInText 2s ease forwards;}
        @keyframes fadeInText { 0% { opacity:0; transform:translateY(10px);} 100% { opacity:1; transform:translateY(0);} }
        #counter { display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin:15px 0;}
        .box { background: rgba(233,30,99,0.1); padding:12px; border-radius:8px; min-width:70px; color:#e91e63; transition: transform 0.3s ease;}
        .box:hover { transform: scale(1.05);}
        .box .number { font-size:2em; font-weight:700;}
        .box .label { font-size:0.7em; text-transform:uppercase; font-weight:400;}
        .number.flip { animation: flipDown 0.5s ease-out;}
        @keyframes flipDown {0% { transform: translateY(-100%); opacity:0;} 100% { transform:translateY(0); opacity:1;}}
        .button-container { display:flex; justify-content:center; gap:10px; margin-top:20px; flex-wrap:wrap;}
        .button {
            text-decoration:none; color:white;
            background:#e91e63;
            padding:8px 16px; border-radius:10px;
            font-size:0.9em; font-weight:500;
            box-shadow:0 4px 15px rgba(233,30,99,0.4);
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .button:hover { background:#f06292; transform:translateY(-3px); box-shadow:0 6px 20px rgba(233,30,99,0.5);}
        .music-toggle { cursor:pointer; position:absolute; top:15px; right:15px; font-size:1.1em; color:#fff; background:#e91e63; padding:6px 10px; border-radius:50%; box-shadow:0 4px 10px rgba(0,0,0,0.3); transition:transform 0.3s ease;}
        body.dark-mode .music-toggle { background: #bb86fc; }
        .music-toggle:hover { transform:scale(1.1); }
        .theme-toggle { cursor:pointer; position:absolute; top:15px; right:60px; font-size:1.1em; color:#fff; background:#e91e63; padding:6px 10px; border-radius:50%; box-shadow:0 4px 10px rgba(0,0,0,0.3); transition:transform 0.3s ease;}
        body.dark-mode .theme-toggle { background: #bb86fc; }
        .theme-toggle:hover { transform:scale(1.1); }
        .volume-control { position:absolute; top:60px; right:15px; display:flex; align-items:center; gap:5px;}
        .volume-control input[type="range"] {
            width:80px; cursor:pointer; accent-color:#e91e63;
        }
        body.dark-mode .volume-control input[type="range"] { accent-color:#bb86fc; }
        canvas { position:absolute; top:0; left:0; z-index:0; }
        .youtube-player { position:absolute; top:0; left:0; width:0; height:0; }
        .message-section { margin-top:15px; display:none;}
        .message-section.active { display:block; }
        .message-input { width:100%; padding:8px; border-radius:8px; border:1px solid #e91e63; font-family:'Roboto', sans-serif; font-size:0.9em; margin-bottom:10px;}
        body.dark-mode .message-input { border-color:#bb86fc; background:#3f3f74; color:#f0e6ff;}
        .saved-message { font-style:italic; color:#e91e63; font-size:0.9em; margin-top:10px;}
        body.dark-mode .saved-message { color:#bb86fc; }
        .loading { display: none; color: #e91e63; font-size: 0.8em; margin-top: 5px; }
        body.dark-mode .loading { color: #bb86fc; }
        @media (max-width: 600px) {
            .main-card { padding:15px; width:95%; max-width:400px; }
            h1 { font-size:1.8em; }
            .subtitle { font-size:0.8em; }
            .greeting { font-size:0.9em; }
            .box { min-width:60px; padding:10px; }
            .box .number { font-size:1.6em; }
            .box .label { font-size:0.65em; }
            .button { font-size:0.8em; padding:7px 14px; }
            .music-toggle { font-size:1em; padding:5px 8px; top:10px; right:10px; }
            .theme-toggle { top:10px; right:50px; font-size:1em; padding:5px 8px; }
            .volume-control { top:50px; right:10px; }
            .volume-control input[type="range"] { width:60px; }
        }
        @media (max-width: 400px) {
            .main-card { padding:12px; }
            h1 { font-size:1.6em; }
            .box { min-width:55px; }
            .button-container { gap:8px; }
        }
    </style>
</head>
<body>
    <div class="bg-overlay"></div>
    <canvas id="heartCanvas"></canvas>
    <canvas id="confettiCanvas"></canvas>
    <div class="main-card">
        <h1>Sen ve Ben</h1>
        <p class="subtitle">Sonsuzluğa akacak bir sayaç...</p>
        <p class="greeting" id="greeting">Seni her an daha çok seviyorum...</p>
        <div id="counter">
            <div class="box"><span id="days" class="number">0</span><span class="label">Gün</span></div>
            <div class="box"><span id="hours" class="number">0</span><span class="label">Saat</span></div>
            <div class="box"><span id="minutes" class="number">0</span><span class="label">Dakika</span></div>
            <div class="box"><span id="seconds" class="number">0</span><span class="label">Saniye</span></div>
        </div>
        <div class="button-container">
            <a href="reasons.html" class="button">Seni Sevmemin Nedenleri</a>
            <a href="cok-guzelsin" class="button">Tıklaa</a>
            <button id="messageButton" class="button">Mesaj Bırak</button>
        </div>
        <div class="message-section" id="messageSection">
            <textarea id="messageInput" class="message-input" placeholder="Kalbinden gelen bir mesaj yaz..."></textarea>
            <button id="saveMessage" class="button">Telegram'a Gönder</button>
            <p id="savedMessage" class="saved-message"></p>
            <p id="loading" class="loading">Mesaj gönderiliyor...</p>
            <p id="errorMessage" style="color: red; font-size: 0.8em; display: none;"></p>
        </div>
    </div>
    <div class="music-toggle" id="musicToggle">♫</div>
    <div class="theme-toggle" id="themeToggle">☀</div>
    <div class="volume-control">
        <label for="volumeSlider" style="color:#fff; font-size:0.9em;">Ses:</label>
        <input type="range" id="volumeSlider" min="0" max="50" value="10">
    </div>
    <div class="youtube-player">
        <iframe id="ytPlayer" width="0" height="0" src="https://www.youtube.com/embed/aDju79MtUR8?enablejsapi=1&autoplay=0&loop=1&playlist=aDju79MtUR8" frameborder="0" allow="autoplay; encrypted-media"></iframe>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
        // Şifre kontrolü
        const password = prompt("Siteye girmek için şifreyi gir:");
        if (password !== "senveben2025") {
            alert("Yanlış şifre, sevgilim! 😄");
            window.location.href = "about:blank";
        }

        // YouTube IFrame API
        let player;
        let isPlaying = false;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('ytPlayer', {
                events: {
                    'onReady': onPlayerReady
                }
            });
        }
        function onPlayerReady(event) {
            player.setLoop(true);
            player.setVolume(10);
            const musicToggle = document.getElementById('musicToggle');
            musicToggle.addEventListener('click', () => {
                if (!player) return;
                if (isPlaying) {
                    player.pauseVideo();
                    musicToggle.textContent = '♫';
                } else {
                    player.playVideo();
                    player.setVolume(document.getElementById('volumeSlider').value);
                    musicToggle.textContent = '❚❚';
                }
                isPlaying = !isPlaying;
            });
            const volumeSlider = document.getElementById('volumeSlider');
            volumeSlider.addEventListener('input', () => {
                if (player) player.setVolume(volumeSlider.value);
            });
        }

        // Sayaç
        const baslangicTarihi = new Date(2025, 4, 30, 6, 16, 0); // 30 Mayıs 2025, 06:16
        const counterSpans = {
            days: document.getElementById('days'),
            hours: document.getElementById('hours'),
            minutes: document.getElementById('minutes'),
            seconds: document.getElementById('seconds')
        };
        let lastMilestone = null;
        function updateCounter() {
            const simdi = new Date();
            const fark = simdi - baslangicTarihi;
            if (fark < 0) return;
            const days = Math.floor(fark / (1000 * 60 * 60 * 24));
            const hours = Math.floor((fark % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((fark % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((fark % (1000 * 60)) / 1000);
            updateSpan(counterSpans.days, days);
            updateSpan(counterSpans.hours, hours);
            updateSpan(counterSpans.minutes, minutes);
            updateSpan(counterSpans.seconds, seconds);
            if (days % 100 === 0 && days !== lastMilestone && days !== 0) {
                fireConfetti();
                lastMilestone = days;
            }
        }
        function updateSpan(span, value) {
            if (span.innerText !== String(value)) {
                span.classList.add('flip');
                span.innerText = value;
                span.addEventListener('animationend', () => { span.classList.remove('flip'); }, { once: true });
            }
        }

        // Konfeti Animasyonu
        const confettiCanvas = document.getElementById('confettiCanvas');
        confettiCanvas.width = window.innerWidth;
        confettiCanvas.height = window.innerHeight;
        function fireConfetti() {
            confetti({
                particleCount: window.innerWidth < 600 ? 50 : 100,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#e91e63', '#f8bbd0', '#bbdefb', '#90caf9'],
                canvas: confettiCanvas
            });
            setTimeout(() => confetti.reset(), 3000);
        }
        window.addEventListener('resize', () => {
            confettiCanvas.width = window.innerWidth;
            confettiCanvas.height = window.innerHeight;
        });

        // 3D hover
        const card = document.querySelector('.main-card');
        if (window.innerWidth > 600) {
            card.addEventListener('mousemove', e => {
                const { left, top, width, height } = card.getBoundingClientRect();
                const x = e.clientX - left - width / 2;
                const y = e.clientY - top - height / 2;
                const rotateX = (y / height) * -30;
                const rotateY = (x / width) * 30;
                card.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            });
            card.addEventListener('mouseleave', () => { card.style.transform = 'rotateX(0) rotateY(0)'; });
        }

        // Dynamic Greeting
        const greetings = [
            "Seni her an daha çok seviyorummm",
            "Her an dahada çok asik oluyorumm",
            "Gözlerinin çok güzel olduğunu söylemişmiydimm?",
            "Her an seninle olmak istiyorum",
            "Çok güzelll olduğunu söylemişmiydimm",
            "Gezide beraber olcağımız her an için çok heycanlıyımm",
            "heransenigörünceheycanlanıyorum"
        ];
        const greetingElement = document.getElementById('greeting');
        let greetingIndex = 0;
        function updateGreeting() {
            greetingElement.style.opacity = 0;
            setTimeout(() => {
                greetingElement.textContent = greetings[greetingIndex];
                greetingElement.style.opacity = 1;
                greetingIndex = (greetingIndex + 1) % greetings.length;
            }, 1000);
        }
        setInterval(updateGreeting, 5000);
        updateGreeting();

        // Heart Particle Animation
        const canvas = document.getElementById('heartCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const particles = [];
        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 8 + 4;
                this.speedX = Math.random() * 0.4 - 0.2;
                this.speedY = Math.random() * 0.4 - 0.2;
            }
            draw() {
                ctx.fillStyle = document.body.classList.contains('dark-mode') ? 'rgba(187, 134, 252, 0.5)' : 'rgba(233, 30, 99, 0.5)';
                ctx.beginPath();
                ctx.moveTo(this.x, this.y + this.size * 0.3);
                ctx.quadraticCurveTo(this.x - this.size * 0.5, this.y - this.size * 0.3, this.x, this.y - this.size * 0.7);
                ctx.quadraticCurveTo(this.x + this.size * 0.5, this.y - this.size * 0.3, this.x, this.y + this.size * 0.3);
                ctx.fill();
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
                if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
            }
        }
        function initParticles() {
            const particleCount = window.innerWidth < 600 ? 5 : 10;
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
        }
        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animateParticles);
        }
        initParticles();
        animateParticles();
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            confettiCanvas.width = window.innerWidth;
            confettiCanvas.height = window.innerHeight;
        });

        // Gece Modu
        const themeToggle = document.getElementById('themeToggle');
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-mode');
            themeToggle.textContent = '☀';
        }
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            themeToggle.textContent = document.body.classList.contains('dark-mode') ? '☀' : '☾';
            localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        });

        // Mesaj Bırak & Telegram Gönderimi
        const messageButton = document.getElementById('messageButton');
        const messageSection = document.getElementById('messageSection');
        const messageInput = document.getElementById('messageInput');
        const saveMessageButton = document.getElementById('saveMessage');
        const savedMessage = document.getElementById('savedMessage');
        const loading = document.getElementById('loading');
        const errorMessage = document.getElementById('errorMessage');

        if (localStorage.getItem('savedMessage')) {
            savedMessage.textContent = localStorage.getItem('savedMessage');
        }

        messageButton.addEventListener('click', () => {
            messageSection.classList.toggle('active');
        });

        saveMessageButton.addEventListener('click', async () => {
            const message = messageInput.value.trim();
            if (message) {
                loading.style.display = 'block';
                errorMessage.style.display = 'none';
                try {
                    const response = await fetch('/.netlify/functions/telegram', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ message })
                    });
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || `HTTP hata: ${response.status}`);
                    }
                    const data = await response.json();
                    savedMessage.textContent = message;
                    localStorage.setItem('savedMessage', message);
                    alert('Mesaj sevgiline gönderildi! ❤️');
                } catch (error) {
                    errorMessage.textContent = 'Hata: ' + error.message;
                    errorMessage.style.display = 'block';
                    alert('Mesaj kaydedildi, ama gönderimde hata: ' + error.message);
                }
                loading.style.display = 'none';
                messageInput.value = '';
                messageSection.classList.remove('active');
            }
        });

        updateCounter();
        setInterval(updateCounter, 1000);

        // Çok Güzelsin butonu .html gizleme
        document.querySelectorAll('a[href$="cok-guzelsin"]').forEach(a => {
            a.addEventListener('click', e => {
                e.preventDefault();
                window.location.href = "cok-guzelsin.html";
            });
        });
    </script>
</body>
</html>
